[{"title":"ã€Œè®ºæ–‡ç³»åˆ—ã€ï¼ˆä¸€ï¼‰æ—·è§†ç§‘æŠ€CVPR2022 CREStereo å®˜æ–¹GitHubä»£ç æ¨ç†è¿è¡Œ","url":"/2022/05/11/ã€Œè®ºæ–‡ç³»åˆ—ã€ï¼ˆä¸€ï¼‰æ—·è§†ç§‘æŠ€CVPR2022 CREStereo å®˜æ–¹GitHubä»£ç æ¨ç†è¿è¡Œ/","content":"\n## è®ºæ–‡ç®€ä»‹ï¼š\n\nCVPR2022è®ºæ–‡     **ã€ŠåŸºäºè‡ªé€‚åº”ç›¸å…³çº§è”é€’å½’ç½‘ç»œçš„å®ç”¨åŒç›®åŒ¹é…ã€‹**\n\nåŸæ–‡é“¾æ¥ï¼šã€Œ[Practical Stereo Matching via Cascaded Recurrent Network with Adaptive Correlation](https://arxiv.org/abs/2203.11483)ã€\n\nä½œè€…è§£è¯»è§†é¢‘ï¼š\n\n<iframe src=\"//player.bilibili.com/player.html?aid=383885340&bvid=BV1oZ4y1h7mL&cid=717464018&page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"> </iframe>\n\n## è¿è¡Œå‡†å¤‡ï¼š\n\nåœ¨**æ’æºäº‘**å¹³å° é…ç½®ä¸€ä¸ª**CUDA10.1**çš„ç¯å¢ƒ è¿™é‡Œé€‰æ‹©**Tesla T4** ã€Œä½¿ç”¨å…¶ä»–å‹å·å¯èƒ½æ— æ³•åªèƒ½è¿›è¡ŒCUDA11åŠä»¥ä¸Šçš„é…ç½®ã€\n\n<!-- more -->\n\n<img src=\"https://tva1.sinaimg.cn/large/e6c9d24ely1h24u0rmh0gj20mt02tt8p.jpg\" alt=\"image-20220511212511378\"  />\n\n![image-20220511212457641](https://tva1.sinaimg.cn/large/e6c9d24ely1h24u0x9dtgj20dg07t3yt.jpg)\n\nè®¾ç½®æˆåŠŸåè¿›å…¥**Jupyter-lab**ï¼Œå®‰è£…**OpenCV**\n\n> å‚è€ƒã€Œhttps://blog.csdn.net/keineahnung2345/article/details/84299532ã€\n\n```\npip install opencv-python\napt-get install -y libglib2.0-0\napt-get install -y libsm6 libxext6\napt-get install -y libxrender-dev\n```\n\nä¹‹åæ ¹æ®å®˜æ–¹GitHubã€Œhttps://github.com/megvii-research/CREStereoã€ è¿›è¡Œæ“ä½œ\n\n> å»ºè®®ä½¿ç”¨Download ZIPè¿›è¡Œä¸‹è½½ ä¹‹åæ”¾å…¥æœåŠ¡å™¨ unzipå‡ºæ¥  git cloneç»å¸¸æŠ½é£å¡åœ¨cloneä¸åŠ¨å¼¹\n\n```\npython3 -m pip install -r requirements.txt\n```\n\n> è¿™é‡Œéœ€è¦æå‰å°†requirements.txt ä¸­çš„ MegEngine>=1.8.2 æ”¹ä¸º MegEngine==1.8.2 é˜²æ­¢å‡ºç°ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜\n\nç„¶åä¸‹è½½ä¸€ä¸ªå®˜æ–¹æä¾›çš„é¢„è®­ç»ƒæ¨¡å‹ã€Œ[Googleç½‘ç›˜é“¾æ¥](https://drive.google.com/file/d/1Wx_-zDQh7BUFBmN9im_26DFpnf3AkXj4/view)ã€æ”¾åˆ°ä¸»ç›®å½•ä¸‹ç”¨äºå‰å‘æ¨ç†\n\næœ€åè¿è¡Œå¦‚ä¸‹ä»£ç ï¼Œå³å¯ç”Ÿæˆ**æ·±åº¦å›¾**\n\n```\npython3 test.py --model_path path_to_mge_model --left img/test/left.png --right img/test/right.png --size 1024x1536 --output disparity.png\n```\n\n## è¿è¡Œç»“æœå±•ç¤º\n\næœ€è¿‘æ­£å¥½åœ¨åšåŒç›®è§†è§‰ç›¸å…³çš„å·¥ä½œï¼Œæœ‰ä¸€äº›åŒç›®çš„ç´ æ\n\nå®éªŒäº†ä¸€ä¸‹çœ‹çœ‹ï¼Œæ•ˆæœè¿˜æ˜¯æŒºä¸é”™çš„ï¼Œä¸‹é¢æ”¾ä¸Šå‡ å¼ æ•ˆæœå›¾\n\nå¦‚æœåé¢èƒ½å¤Ÿåˆ©ç”¨å£°çº³æµ‹è·æˆ–è€…å…¶ä»–æ–¹æ³• åšä¸€ä¸ªæ°´ä¸‹è é²¼åŒç›®åŒ¹é…çš„çš„çœŸå€¼æ•°æ®é›†å°±æ›´å¥½\n\n|                            å·¦ä¾§å›¾                            |                            å³ä¾§å›¾                            |                            æ·±åº¦å›¾                            |\n| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |\n| ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uqkkb4ej20zk0k0q53.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uqkkb4ej20zk0k0q53.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24ut82ysij20zk0k0t97.jpg) |\n| ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24up9kgcej20zk0k0tak.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24upf2e6jj20zk0k0wgb.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uukp9oxj20zk0k0aav.jpg) |\n| ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uww73g7j20zk0k0whd.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uww73g7j20zk0k0whd.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24ux180a4j20zk0k0q3s.jpg) |\n| ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uyh35k6j20zk0k0whf.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uyeiq49j20zk0k0tbo.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24uyft7d6j20zk0k0jsd.jpg) |\n| ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24v0hv9urj20zk0k0dip.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24v0hv9urj20zk0k0dip.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24v0ts6ulj20zk0k0gmk.jpg) |\n| ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24v658pitj20zk0k0mzc.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24v64j9edj20zk0k0dhv.jpg) | ![](https://tva1.sinaimg.cn/large/e6c9d24ely1h24v633e4hj20zk0k03z6.jpg) |\n\n","tags":["è®ºæ–‡ç³»åˆ—"]},{"title":"ã€Œè é²¼é¡¹ç›®ã€ï¼ˆä¸€ï¼‰æ°´ä¸‹ä»¿ç”Ÿè é²¼æ•°æ®é›†è·å–åŠVOCæ ¼å¼è½¬åŒ–ä¸ºCOCOæ ¼å¼","url":"/2022/05/10/ã€Œè é²¼é¡¹ç›®ã€ï¼ˆä¸€ï¼‰æ°´ä¸‹ä»¿ç”Ÿè é²¼æ•°æ®é›†è·å–åŠVOCæ ¼å¼è½¬åŒ–ä¸ºCOCOæ ¼å¼/","content":"\n## æ‹æ‘„æµç¨‹ï¼š\n\nä½¿ç”¨æ‰‹æœºç›¸æœºğŸ“±ã€æ°´å¯†ç›¸æœºğŸ“·ã€Œåé¢è¿›æ°´äº†ğŸ˜­ã€è¿˜æœ‰å›ºå®šåœ¨æ°´æ± ç»ç’ƒå›´æ ä¸Šçš„æ°´å¯†ç›‘æ§ğŸ“¹è¿›è¡Œå½•åƒ\n\nè é²¼å›¢é˜Ÿçš„åŒå­¦å¸®å¿™æ“çºµè é²¼è¿›è¡Œå„ç§å§¿æ€çš„è¿åŠ¨ï¼Œä¿è¯è é²¼çš„å„ä¸ªè§’åº¦éƒ½è¢«æ•æ‰åˆ°\n\nåæœŸç»è¿‡ç²—ç•¥çš„å‰ªè¾‘ã€Œæœ‰è é²¼çš„ç•™ä¸‹ï¼Œæ²¡æœ‰è é²¼çš„åˆ æ‰ã€å¾—åˆ°åŸå§‹è§†é¢‘\n\n> è¿™é‡Œå‡ºç°äº†â€œä¸€å·å‘â€ï¼šæ°´å¯†ç›‘æ§æ˜¯ç½‘ç»œä¼ è¾“æ ¼å¼ï¼Œéœ€è¦ç‰¹æ®Šçš„ä¸Šä½æœºè¿›è¡Œå½•åƒï¼ŒåæœŸä¹Ÿéœ€è¦å•ç‹¬ä¸‹è½½VLCè½¯ä»¶è¿›è¡Œè§†é¢‘æ ¼å¼è½¬æ¢ï¼Œç›´æ¥åŒå‡»æºæ–‡ä»¶æ˜¯æ’­æ”¾ä¸äº†çš„\n\n## è§†é¢‘åˆ‡åˆ†ä¸ºå›¾ç‰‡ï¼š\n\næœ‰äº†åŸå§‹è§†é¢‘å°±è¦è¿›è¡Œåˆ‡åˆ†å¾—åˆ°å›¾ç‰‡ï¼Œè¿™é‡Œç”¨è°ƒç”¨OpenCVçš„â€œè½®å­â€è¿›è¡Œåˆ‡åˆ†ï¼Œåˆ‡åˆ†æ ‡å‡†ä¸ºæ¯10å¸§åˆ‡1å¼ \n\nä¸‹é¢è´´ä¸Šä»£ç ï¼š\n\n<!-- more -->\n```python\n# -*- coding:UTF-8 -*-\n\"\"\"\n# @file name  : video2image.py\n# @author     : zz0320\n# @brief      : å°†è§†é¢‘åˆ‡åˆ†ä¸ºå›¾ç‰‡\n\"\"\"\n\nimport cv2\n\n# å®šä¹‰ä¿å­˜å›¾ç‰‡å‡½æ•°\n# image:è¦ä¿å­˜çš„å›¾ç‰‡åå­—\n# addrï¼›å›¾ç‰‡åœ°å€ä¸ç›¸ç‰‡åå­—çš„å‰éƒ¨åˆ†\n# num: ç›¸ç‰‡ï¼Œåå­—çš„åç¼€ã€‚int ç±»å‹\ndef save_image(image, addr, num):\n    address = addr + str(num) + '.jpg'\n    cv2.imwrite(address, image)\n\n\n# è¯»å–è§†é¢‘æ–‡ä»¶\n\nj = 0\nvideo_name = \"IMG_8777.mp4\"  # è§†é¢‘åç§°\nvideo_dir = \"/Users/kenton/Downloads/é›†ç¾¤é‡ç‚¹ç ”å‘/è é²¼æ•°æ®é›†/video/\"  # è§†é¢‘æ ¹ç›®å½•\nvideoCapture = cv2.VideoCapture(video_dir + video_name)\n\n# videoCapture=cv2.VideoCapture(1) # è¿™é‡Œå°±æ˜¯ç›´æ¥è°ƒç”¨æ‘„åƒå¤´\n\n# è¯»å¸§\nsuccess, frame = videoCapture.read()\n\ntimeF = 10  # æŒ‰éœ€æ›´æ”¹\ni = 0\nwhile success:\n    i = i + 1\n    if (i % timeF == 0):\n        s = 10000\n        j = j + 1\n        s += j\n        save_image(frame, '/Users/kenton/Downloads/é›†ç¾¤é‡ç‚¹ç ”å‘/è é²¼æ•°æ®é›†/video/test/{}'.format(video_name[:-4]), s)\n        # {}å‰çš„éƒ¨åˆ†ä¸ºä¿å­˜è§†é¢‘çš„åœ°å€\n        print('save image:', i)\n    success, frame = videoCapture.read()\n```\n\n## æ ‡ç­¾è®¾å®šä¸æ ‡ç­¾æ ‡å®šï¼š\n\nåˆ‡åˆ†å®Œä»¥åå°±å¾—åˆ°**ä¸€å †ä¸€å †çš„å›¾ç‰‡**ã€Œå…«åƒå¤šå¼ ã€\n\nç„¶åæ‰¾å¸ˆå§å’Œå¸ˆå¼Ÿå¸®å¿™ä¸€èµ·æ‰“æ ‡ç­¾ã€Œéå¸¸æ„Ÿè°¢ğŸ™ã€\n\næ‰“æ ‡ç­¾æ˜¯åœ¨ã€Œhttps://www.makesense.ai/ã€è¿™ä¸ªç½‘ç«™ä¸Šæ‰“çš„\n\nè¾“å‡ºæ ¼å¼å¯ä»¥é€‰æ‹©ä¸º**VOC**ã€**YOLO**æˆ–è€…ç›´æ¥**XML**\n\n**æ ‡ç­¾**æŒ‰ç…§ç›¸æœºç›¸å¯¹äºè é²¼çš„ä½ç½®ä¸€å…±è®¾å®šäº†**8ä¸ªç±»**ï¼Œåˆ†åˆ«ä¸ºã€Œ**left_front**ï¼Œ**left_rear**ï¼Œ**right_front**ï¼Œ**right_rear**ï¼Œ**front**ï¼Œ**rear**ï¼Œ**left**ï¼Œ**right**ã€\n\n> è¿™é‡Œæ˜¯â€œäºŒå·å‘â€ï¼šæœ€æ—©çš„æ—¶å€™æ‰“çš„æ ‡ç­¾æ˜¯ä¸­æ–‡ï¼Œä½†æ˜¯åé¢æ¨ç†çš„æ—¶å€™æ— æ³•æ­£ç¡®åœ¨å›¾ç‰‡ä¸Šè¾“å‡ºä¸­æ–‡ï¼Œæ‰€ä»¥åœ¨åé¢è¿›è¡Œæ ‡ç­¾è½¬åŒ–çš„æ—¶å€™éœ€è¦è¿›è¡Œè‹±æ–‡æ›¿æ¢ï¼Œè€Œä¸”è¿™å…«ä¸ªç±»çš„é¡ºåºä¹Ÿååˆ†ååˆ†ååˆ†é‡è¦ï¼Œä¼šå½±å“åˆ°åé¢lossçš„è®¡ç®—ã€‚\n\nä¸‹é¢æ˜¯æ‰“æ ‡ç½‘ç«™çš„ç•Œé¢å’Œæ‰“æ ‡çš„éƒ¨åˆ†å®å†µæˆªå›¾\n\n<img src=\"https://wx2.sinaimg.cn/large/005XjMv9ly1h23cjwewxsj30xi0rajyn.jpg\" width=80% height=50% align=center referrerpolicy=\"no-referrer\"/>\n\n<img src=\"https://wx4.sinaimg.cn/large/005XjMv9ly1h23cjvruujj30xu0iwn3c.jpg\" width=80% height=50% align=center referrerpolicy=\"no-referrer\"/>\n\n## æ–‡ä»¶è¿‡æ»¤\n\nå› ä¸ºæ‰“æ ‡ç­¾çš„æ—¶å€™æ˜¯å›¾ç‰‡æ–‡ä»¶-æ ‡ç­¾æ–‡ä»¶ä¸€ä¸€å¯¹åº”çš„ï¼Œå¦‚æœæ‰“æ ‡è¿‡ç¨‹ä¸­é‡åˆ°ä¸€äº›è´¨é‡è¾ƒä½çš„å›¾ç‰‡å°±ä¼šé€‰æ‹©è·³è¿‡ä¸æ‰“æ ‡ç­¾\n\nè¿™å°±é€ æˆäº†æœ‰éƒ¨åˆ†å›¾ç‰‡å¹¶æ²¡æœ‰æ ‡ç­¾ï¼Œæˆ‘ä»¬éœ€è¦å»æ‰è¿™äº›æ— æ ‡ç­¾çš„å›¾ç‰‡ï¼Œè¿™é‡Œç”¨æ ‡ç­¾æ–‡ä»¶åã€Œä¸å«.xmlã€è¿›è¡ŒåŒ¹é…è¿‡æ»¤è¿™äº›ã€Œæ— ç”¨ã€å›¾ç‰‡\n\nç¨‹åºå¦‚ä¸‹ï¼š\n\n```python\n# -*- coding:UTF-8 -*-\n\"\"\"\n# @file name  : remove_useless_image.py\n# @author     : zz0320\n# @brief      : åˆ é™¤æ²¡æœ‰æ ‡ç­¾çš„ç…§ç‰‡\n\"\"\"\n\nimport os\n\npath1 = r\"/Users/kenton/Downloads/é›†ç¾¤é‡ç‚¹ç ”å‘/è é²¼æ•°æ®é›†/jpg/å¤„ç†ç»“æœé›†åˆ/æ•°æ®å¯¹é½ä¸åˆ†å‰²ç¨‹åº/VOCdevkit/VOC2007/Annotations\"       #å¯¹æ¯”çš„æ–‡ä»¶å¤¹ï¼ˆæ ‡ç­¾æ–‡ä»¶å¤¹ï¼‰\npath2 = r\"/Users/kenton/Downloads/é›†ç¾¤é‡ç‚¹ç ”å‘/è é²¼æ•°æ®é›†/jpg/å¤„ç†ç»“æœé›†åˆ/æ•°æ®å¯¹é½ä¸åˆ†å‰²ç¨‹åº/VOCdevkit/VOC2007/JPEGImages\"        #åˆ é™¤æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼ˆå›¾ç‰‡æ–‡ä»¶å¤¹ï¼‰\nfilelist1 = os.listdir(path1) #è¯¥æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼ˆåŒ…æ‹¬æ–‡ä»¶å¤¹ï¼‰\nfilelist2 = os.listdir(path2)\ntp = \".xml\"      #è¦åŒ¹é…æ ‡ç­¾æ–‡ä»¶çš„åç¼€\n\n\nfor file2 in filelist2:\n    filename = os.path.splitext(file2)[0] + tp  # åŒ¹é…æ–‡ä»¶å\n    if filename not in filelist1:           #å¦‚æœæ²¡æœ‰å¯¹åº”åŒ¹é…æ–‡ä»¶ï¼Œå°±åˆ é™¤\n        os.remove(os.path.join(path2, file2))\n\n```\n\n\n\n## VOCæ ‡ç­¾æ ¼å¼ï¼š\n\nç½‘ç«™æ‰“æ ‡ç­¾åè¾“å‡ºçš„æ–‡ä»¶æ ¼å¼æ²¡æœ‰COCOæ ¼å¼å¯ä»¥é€‰æ‹©ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œé€‰æ‹©VOCæ•°æ®é›†ï¼Œæ–¹ä¾¿åæœŸçš„è½¬æ¢\n\nè¿™é‡Œä»‹ç»ä¸€ä¸‹VOCæ ‡ç­¾çš„å­˜æ”¾æ ¼å¼å’Œå†…éƒ¨æ ¼å¼\n\nå­˜æ”¾æ ¼å¼å¦‚ä¸‹ï¼šã€Œåªè€ƒè™‘ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€\n\n```\n#ç¬¬ä¸€çº§\nVOCdevkit\nâ”œâ”€â”€ VOC2007\nâ””â”€â”€ VOC2012\n#ç¬¬äºŒçº§\nVOCdevkit/VOC2007\nâ”œâ”€â”€ Annotations\nâ”œâ”€â”€ ImageSets\nâ”œâ”€â”€ JPEGImages\n\nVOCdevkit/VOC2012\nâ”œâ”€â”€ Annotations\nâ”œâ”€â”€ ImageSets\nâ”œâ”€â”€ JPEGImages\n\n#ä»¥VOC2007ä¸ºä¾‹ï¼Œç¬¬ä¸‰çº§\n## Annotations\nVOCdevkit/VOC2007/Annotations/\nâ”œâ”€â”€ 000001.xml\n...\n## JPEGImages\nVOCdevkit/VOC2007/JPEGImages/\nâ”œâ”€â”€ 000001.jpg\n...\n\n```\n\nå†…éƒ¨æ ¼å¼å¦‚ä¸‹ï¼š\n\n```xml\n<annotation>\n\t<folder>æ²¹ç½è½¦å›¾ç‰‡</folder>\n\t<filename>1.jpg</filename>\n\t<path>D:\\Desktop\\æ²¹ç½è½¦å›¾ç‰‡\\1.jpg</path>\n\t<source>\n\t\t<database>Unknown</database>\n\t</source>\n\t<size>\n\t\t<width>312</width>\n\t\t<height>208</height>\n\t\t<depth>3</depth>\n\t</size>\n\t<segmented>0</segmented>\n\t<object>\n\t\t<name>redCap</name>\n\t\t<pose>Unspecified</pose>\n\t\t<truncated>0</truncated>\n\t\t<difficult>0</difficult>\n\t\t<bndbox>\n\t\t\t<xmin>43</xmin>\n\t\t\t<ymin>92</ymin>\n\t\t\t<xmax>96</xmax>\n\t\t\t<ymax>144</ymax>\n\t\t</bndbox>\n\t</object>\n\t<object>\n\t\t<name>yellowCap</name>\n\t\t<pose>Unspecified</pose>\n\t\t<truncated>0</truncated>\n\t\t<difficult>0</difficult>\n\t\t<bndbox>\n\t\t\t<xmin>147</xmin>\n\t\t\t<ymin>98</ymin>\n\t\t\t<xmax>198</xmax>\n\t\t\t<ymax>151</ymax>\n\t\t</bndbox>\n\t</object>\n\t<object>\n\t\t<name>oilTruck</name>\n\t\t<pose>Unspecified</pose>\n\t\t<truncated>0</truncated>\n\t\t<difficult>0</difficult>\n\t\t<bndbox>\n\t\t\t<xmin>111</xmin>\n\t\t\t<ymin>46</ymin>\n\t\t\t<xmax>266</xmax>\n\t\t\t<ymax>157</ymax>\n\t\t</bndbox>\n\t</object>\n</annotation>\n```\n\nè¿™é‡Œå¦‚æœéœ€è¦è¿›è¡Œæ ‡ç­¾è½¬æ¢çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œæ›¿æ¢ï¼š\n\n```python\n# -*- coding:UTF-8 -*-\n\"\"\"\n# @file name  : chang_xml_label.py\n# @author     : zz0320\n# @brief      : æ‰¹é‡ä¿®æ”¹xmlæ–‡ä»¶ä¸­çš„ç±»åˆ«åç§° å½“æœ‰å¤šä¸ªç‰©ä½“æ—¶ï¼Œå¤šä¸ªç‰©ä½“çš„åç§°å‡èƒ½è¢«ä¿®æ”¹\n\"\"\"\n\nfrom lxml.etree import Element, SubElement, tostring, ElementTree\nfrom xml.dom import minidom\nimport xml.etree.ElementTree as ET\nfrom xml.etree import ElementTree as etree\nimport os\nimport re\nfrom lxml import etree\n# ä¿®æ”¹è‡ªå·±çš„è·¯å¾„\n# parser = ET.XMLParser(encoding=\"utf-8\")\ntemplate_file = r'/Users/kenton/Downloads/é›†ç¾¤é‡ç‚¹ç ”å‘/è é²¼æ•°æ®é›†/jpg/å¤„ç†ç»“æœé›†åˆ/VOCdevkit/VOC2007/Annotations/'  #è¿™é‡Œæ˜¯å­˜æ”¾xmlæ–‡ä»¶çš„æ–‡ä»¶å¤¹\nxmllist = os.listdir(template_file)\n# text = re.sub(u\"[\\x00-\\x08\\x0b-\\x0c\\x0e-\\x1f]+\", u\"\", text)\nfor xml in xmllist:\n    if xml == '.DS_Store':\n        continue\n    # print(xml)\n    file = open(os.path.join(template_file, xml)).read()\n    # print(type(file))\n    file = file.replace(\"&amp;\", \"_\")\n    file = file.replace(\"&\", \"_\")\n    # print(file)\n    tree = ET.ElementTree(ET.fromstring(file))\n    root = tree.getroot() # è·å–æ ¹èŠ‚ç‚¹\n    for child in root:\n\n        print(child.tag,child.attrib)\n        if child.tag == 'object':\n            name=child.find('name').text\n            # print(name)\n            if name == 'å·¦å‰':\n                child.find('name').text='left_front'\n                tree=ET.ElementTree(root)\n            elif name == 'å·¦å':\n                child.find('name').text = 'left_rear'\n                tree = ET.ElementTree(root)\n            elif name == 'å³å‰':\n                child.find('name').text = 'right_front'\n                tree = ET.ElementTree(root)\n            elif name == 'å³å':\n                child.find('name').text = 'right_rear'\n                tree = ET.ElementTree(root)\n            elif name == 'å‰ä¾§':\n                child.find('name').text = 'front'\n                tree = ET.ElementTree(root)\n            elif name == 'åä¾§':\n                child.find('name').text = 'rear'\n                tree = ET.ElementTree(root)\n            elif name == 'å·¦ä¾§':\n                child.find('name').text = 'left'\n                tree = ET.ElementTree(root)\n            elif name == 'å³ä¾§':\n                child.find('name').text = 'right'\n                tree = ET.ElementTree(root)\n    # print(tree)\n    tree.write(os.path.join(template_file, xml))\n```\n\n> è¿™é‡Œæœ‰ä¸ªâ€œä¸‰å·å‘â€ï¼šæ¯æ¬¡ç³»ç»Ÿè¿è¡Œçš„æ—¶å€™éƒ½ä¼šå‡ºç°\".DS_Store\"æˆ–è€…jupyterä¸‹é¢çš„æ—¶å€™å‡ºç°\".jupyter xxxx\"çš„ç±»ä¼¼æ–‡ä»¶ï¼Œå¦‚æœç¨‹åºæŠ¥é”™å¯ä»¥è€ƒè™‘å¿½ç•¥è¿™ç§æ–‡ä»¶\n\nè¿™é‡Œè¿˜å¯ä»¥å»¶ä¼¸å‡ºä¸€ä¸ªè®¡æ•°ç¨‹åºï¼Œå¯ä»¥ç”¨äºåˆ¤å®šç¨‹åºä¸­å„ç±»çš„ç±»åˆ«æ•°é‡ï¼Œå¦‚ä¸‹ï¼š\n\n```python\n# -*- coding:UTF-8 -*-\n\"\"\"\n# @file name  : count.py\n# @author     : zz0320\n# @brief      : å„ç±»æ•°é‡ç»Ÿè®¡\n\"\"\"\n\nimport xml.etree.ElementTree as ET\nimport os\n# ä¿®æ”¹è‡ªå·±çš„è·¯å¾„\ncount0 = count1 = count2 = count3 = count4 = count5 = count6 = count7 = 0\ntemplate_file = r'/Users/kenton/Downloads/é›†ç¾¤é‡ç‚¹ç ”å‘/è é²¼æ•°æ®é›†/jpg/å¤„ç†ç»“æœé›†åˆ/VOCdevkit/VOC2007/Annotations'  #è¿™é‡Œæ˜¯å­˜æ”¾xmlæ–‡ä»¶çš„æ–‡ä»¶å¤¹\nxmllist = os.listdir(template_file)\nfor xml in xmllist:\n    if xml == '.DS_Store':\n        continue\n    # print(xml)\n\n    # tree = ET.parse(os.path.join(template_file,xml))\n    # root = tree.getroot() # è·å–æ ¹èŠ‚ç‚¹\n\n    # print(xml)\n    file = open(os.path.join(template_file, xml)).read()\n    # print(type(file))\n    file = file.replace(\"&amp;\", \"_\")\n    file = file.replace(\"&\", \"_\")\n    # print(file)\n    tree = ET.ElementTree(ET.fromstring(file))\n    root = tree.getroot() # è·å–æ ¹èŠ‚ç‚¹\n    for child in root:\n        # print(child.tag,child.attrib)\n        if child.tag == 'object':\n            name=child.find('name').text\n            # print(name)\n            if name == 'left_front':\n                count0 += 1\n            elif name == 'left_rear':\n                count1 += 1\n\n            elif name == 'right_front':\n                count2 += 1\n\n            elif name == 'right_rear':\n                count3 += 1\n\n            elif name == 'front':\n                count4 += 1\n\n            elif name == 'rear':\n                count5 += 1\n\n            elif name == 'left':\n                count6 += 1\n\n            elif name == 'right':\n                count7 += 1\n\nprint(count0,count1,count2,count3,count4,count5,count6,count7)\n```\n\n## COCOæ•°æ®æ ¼å¼\n\ncocoæ•°æ®é›†çš„æ ¼å¼å®åœ¨æ˜¯æœ‰äº›ç¹çï¼Œé™äºç¯‡å¹… è¿™é‡Œè´´ä¸€ä¸ªé“¾æ¥ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹\n\n> https://zhuanlan.zhihu.com/p/29393415\n\n## è½¬åŒ–æˆCOCOæ ¼å¼ï¼š\n\nä¸‹é¢å°±æ˜¯vocæ ¼å¼è½¬æˆcocoçš„ç¨‹åº é¡ºå¸¦å¯ä»¥è¿›è¡Œæ•°æ®é›†çš„éšæœºåˆ’åˆ† åˆ’åˆ†ä¸ºã€Œè®­ç»ƒé›†trainã€ã€ŒéªŒè¯é›†valã€ã€Œæµ‹è¯•é›†testã€\n\nè¿è¡Œåå¯ä»¥ç›´æ¥ç”Ÿæˆcocoçš„æ–‡ä»¶åˆ†å¸ƒå’Œjsonæ–‡ä»¶\n\n> è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªâ€œå››å·å‘â€ï¼šä»£ç ä¸­æ®µdef convertå‡½æ•°ä¸‹é¢æœ‰ä¸€ä¸ªStartIndexè¿™ä¸ªæ˜¯ç”Ÿæˆçš„jsonæ–‡ä»¶ä¸­å›¾ç‰‡ç±»åˆ«çš„èµ·å§‹è®¡æ•°æ•°å€¼ï¼Œè¿™é‡Œä¸€å®šè¦æ”¹æˆä¸€ä¸ªå¤©é©¬è¡Œç©ºçš„æ•°å­—ï¼Œæˆ‘è¿™é‡Œæ˜¯è®¾å®šçš„21800ï¼Œå› ä¸ºä¸è¿™ä¹ˆè®¾å®šä¼šå’Œåé¢æ ‡ç­¾çš„è®¡æ•°å†²çªã€Œéƒ½æ˜¯èµ·å§‹0ã€ï¼Œå¯¼è‡´è®­ç»ƒæ—¶éƒ¨åˆ†losså§‹ç»ˆä¸º0\n\n```python\n# -*- coding:UTF-8 -*-\n\"\"\"\n# @file name  : voc2coco.py\n# @author     : zz0320\n# @brief      : vocæ ¼å¼è½¬æˆcoco & æ•°æ®é›†åˆ’åˆ†\n\"\"\"\nimport os\nimport random\nimport shutil\nimport sys\nimport json\nimport glob\nimport xml.etree.ElementTree as ET\n\n\n\"\"\"\nYou only need to set the following three parts\n1.val_files_num : num of validation samples from your all samples\n2.test_files_num = num of test samples from your all samples\n3.voc_annotations : path to your VOC dataset Annotations\n \n\"\"\"\nval_files_num = 500\ntest_files_num = 200\nvoc_annotations = '/Users/kenton/Downloads/é›†ç¾¤é‡ç‚¹ç ”å‘/è é²¼æ•°æ®é›†/jpg/å¤„ç†ç»“æœé›†åˆ/VOCdevkit/VOC2007/Annotations/'\n#vocæ•°æ®é›†annotationsçš„åœ°å€\n\nsplit = voc_annotations.split('/')\ncoco_name = split[-3]\ndel split[-3]\ndel split[-2]\ndel split[-1]\ndel split[0]\n# print(split)\nmain_path = ''\nfor i in split:\n    main_path += '/' + i\n\nmain_path = main_path + '/'\n\n# print(main_path)\n\ncoco_path = os.path.join(main_path, coco_name+'_COCO/')\ncoco_images = os.path.join(main_path, coco_name+'_COCO/images')\ncoco_json_annotations = os.path.join(main_path, coco_name+'_COCO/annotations/')\nxml_val = os.path.join(main_path, 'xml', 'xml_val/')\nxml_test = os.path.join(main_path, 'xml/', 'xml_test/')\nxml_train = os.path.join(main_path, 'xml/', 'xml_train/')\n\nvoc_images = os.path.join(main_path, coco_name, 'JPEGImages/')\n\ndef mkdir(path):\n    path=path.strip()\n    path=path.rstrip(\"\\\\\")\n    isExists=os.path.exists(path)\n    if not isExists:\n        os.makedirs(path)\n        print(path+' ----- folder created')\n        return True\n    else:\n        print(path+' ----- folder existed')\n        return False\nmkdir(coco_path)\nmkdir(coco_images)\nmkdir(coco_json_annotations)\nmkdir(xml_val)\nmkdir(xml_test)\nmkdir(xml_train)\n\n#voc images copy to coco images\nfor i in os.listdir(voc_images):\n    img_path = os.path.join(voc_images + i)\n    shutil.copy(img_path, coco_images)\n    # voc images copy to coco images\nfor i in os.listdir(voc_annotations):\n    img_path = os.path.join(voc_annotations + i)\n    shutil.copy(img_path, xml_train)\n\nprint(\"\\n\\n %s files copied to %s\" % (val_files_num, xml_val))\n\nfor i in range(val_files_num):\n    if len(os.listdir(xml_train)) > 0:\n\n        random_file = random.choice(os.listdir(xml_train))\n        #         print(\"%d) %s\"%(i+1,random_file))\n        source_file = \"%s/%s\" % (xml_train, random_file)\n\n        if random_file not in os.listdir(xml_val):\n            shutil.move(source_file, xml_val)\n        else:\n            random_file = random.choice(os.listdir(xml_train))\n            source_file = \"%s/%s\" % (xml_train, random_file)\n            shutil.move(source_file, xml_val)\n    else:\n        print('The folders are empty, please make sure there are enough %d file to move' % (val_files_num))\n        break\n\nfor i in range(test_files_num):\n    if len(os.listdir(xml_train)) > 0:\n\n        random_file = random.choice(os.listdir(xml_train))\n        #         print(\"%d) %s\"%(i+1,random_file))\n        source_file = \"%s/%s\" % (xml_train, random_file)\n\n        if random_file not in os.listdir(xml_test):\n            shutil.move(source_file, xml_test)\n        else:\n            random_file = random.choice(os.listdir(xml_train))\n            source_file = \"%s/%s\" % (xml_train, random_file)\n            shutil.move(source_file, xml_test)\n    else:\n        print('The folders are empty, please make sure there are enough %d file to move' % (val_files_num))\n        break\n\nprint(\"\\n\\n\" + \"*\" * 27 + \"[ Done ! Go check your file ]\" + \"*\" * 28)\n\n# !/usr/bin/python\n\n# pip install lxml\n\n\nSTART_BOUNDING_BOX_ID = 1\n# PRE_DEFINE_CATEGORIES = None\n\n\n# If necessary, pre-define category and its id\nPRE_DEFINE_CATEGORIES = {\"left_front\": 0, \"left_rear\": 1, \"right_front\": 2, \"right_rear\": 3,\n    \"front\": 4, \"rear\": 5, \"left\": 6, \"right\": 7}\n\n\"\"\"\nmain code below are from\nhttps://github.com/Tony607/voc2coco\n\"\"\"\n\n\ndef get(root, name):\n    vars = root.findall(name)\n    return vars\n\n\ndef get_and_check(root, name, length):\n    vars = root.findall(name)\n    if len(vars) == 0:\n        raise ValueError(\"Can not find %s in %s.\" % (name, root.tag))\n    if length > 0 and len(vars) != length:\n        raise ValueError(\n            \"The size of %s is supposed to be %d, but is %d.\"\n            % (name, length, len(vars))\n        )\n    if length == 1:\n        vars = vars[0]\n    return vars\n\n\ndef get_filename_as_int(filename):\n    try:\n        filename = filename.replace(\"\\\\\", \"/\")\n        filename = os.path.splitext(os.path.basename(filename))[0]\n        return int(filename)\n    except:\n        raise ValueError(\"Filename %s is supposed to be an integer.\" % (filename))\n\n\ndef get_categories(xml_files):\n    \"\"\"Generate category name to id mapping from a list of xml files.\n\n    Arguments:\n        xml_files {list} -- A list of xml file paths.\n\n    Returns:\n        dict -- category name to id mapping.\n    \"\"\"\n    classes_names = []\n    for xml_file in xml_files:\n        file = open(xml_file).read()\n        file = file.replace(\"&amp;\", \"_\")\n        file = file.replace(\"&\", \"_\")\n        # print(file)\n        tree = ET.ElementTree(ET.fromstring(file))\n        root = tree.getroot()  # è·å–æ ¹èŠ‚ç‚¹\n        # tree = ET.parse(xml_file)\n        # root = tree.getroot()\n        for member in root.findall(\"object\"):\n            classes_names.append(member[0].text)\n    classes_names = list(set(classes_names))\n    classes_names.sort()\n    return {name: i for i, name in enumerate(classes_names)}\n\n\ndef convert(xml_files, json_file):\n    json_dict = {\"images\": [], \"type\": \"instances\", \"annotations\": [], \"categories\": []}\n    if PRE_DEFINE_CATEGORIES is not None:\n        categories = PRE_DEFINE_CATEGORIES\n    else:\n        categories = get_categories(xml_files)\n    bnd_id = START_BOUNDING_BOX_ID\n    startIndex = 21800 # ä¿®æ”¹è¿™ä¸ªå¾ˆé‡è¦ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼\n    for xml_file in xml_files:\n        file = open(xml_file).read()\n        file = file.replace(\"&amp;\", \"_\")\n        file = file.replace(\"&\", \"_\")\n        # print(file)\n        tree = ET.ElementTree(ET.fromstring(file))\n        root = tree.getroot()  # è·å–æ ¹èŠ‚ç‚¹\n        # tree = ET.parse(xml_file)\n        # root = tree.getroot()\n        path = get(root, \"path\")\n        if len(path) == 1:\n            filename = os.path.basename(path[0].text)\n        elif len(path) == 0:\n            filename = get_and_check(root, \"filename\", 1).text\n        else:\n            raise ValueError(\"%d paths found in %s\" % (len(path), xml_file))\n        ## The filename must be a number\n        image_id = startIndex\n        startIndex += 1\n        size = get_and_check(root, \"size\", 1)\n        width = int(get_and_check(size, \"width\", 1).text)\n        height = int(get_and_check(size, \"height\", 1).text)\n        image = {\n            \"file_name\": filename,\n            \"height\": height,\n            \"width\": width,\n            \"id\": image_id,\n        }\n        json_dict[\"images\"].append(image)\n        ## Currently we do not support segmentation.\n        #  segmented = get_and_check(root, 'segmented', 1).text\n        #  assert segmented == '0'\n        for obj in get(root, \"object\"):\n            category = get_and_check(obj, \"name\", 1).text\n            if category not in categories:\n                new_id = len(categories)\n                categories[category] = new_id\n            category_id = categories[category]\n            bndbox = get_and_check(obj, \"bndbox\", 1)\n            xmin = int(get_and_check(bndbox, \"xmin\", 1).text) - 1\n            ymin = int(get_and_check(bndbox, \"ymin\", 1).text) - 1\n            xmax = int(get_and_check(bndbox, \"xmax\", 1).text)\n            ymax = int(get_and_check(bndbox, \"ymax\", 1).text)\n            assert xmax > xmin\n            assert ymax > ymin\n            o_width = abs(xmax - xmin)\n            o_height = abs(ymax - ymin)\n            ann = {\n                \"area\": o_width * o_height,\n                \"iscrowd\": 0,\n                \"image_id\": image_id,\n                \"bbox\": [xmin, ymin, o_width, o_height],\n                \"category_id\": category_id,\n                \"id\": bnd_id,\n                \"ignore\": 0,\n                \"segmentation\": [],\n            }\n            json_dict[\"annotations\"].append(ann)\n            bnd_id = bnd_id + 1\n\n    for cate, cid in categories.items():\n        cat = {\"supercategory\": \"none\", \"id\": cid, \"name\": cate}\n        json_dict[\"categories\"].append(cat)\n\n    os.makedirs(os.path.dirname(json_file), exist_ok=True)\n    json_fp = open(json_file, \"w\")\n    json_str = json.dumps(json_dict)\n    json_fp.write(json_str)\n    json_fp.close()\n\n\nxml_val_files = glob.glob(os.path.join(xml_val, \"*.xml\"))\nxml_test_files = glob.glob(os.path.join(xml_test, \"*.xml\"))\nxml_train_files = glob.glob(os.path.join(xml_train, \"*.xml\"))\n\nconvert(xml_val_files, coco_json_annotations + 'val2017.json')\nconvert(xml_test_files, coco_json_annotations+'test2017.json')\nconvert(xml_train_files, coco_json_annotations + 'train2017.json')\n```\n\n","tags":["è é²¼é¡¹ç›®"]},{"title":"Hello World","url":"/2022/05/08/hello-world/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n<!-- more -->\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n"}]