<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7CCourier+New:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/silver/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"username.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="论文简介论文作者呈现了一种仅需要单个深度神经网络的目标检测算法「端到端」；设计其在不同尺寸的特征图下进行预测以处理不同尺度大小的物体；摒弃了之前那种双阶段目标检测器需要生成$Region\  Proposal$和特征再筛选的过程；基于$Nvidia\  Titan\  X$上，针对大小为300*300大小的输入，在VOC2007数据集上测试的$mAP$为$74.3%$，速度为$59FPS$，对于5">
<meta property="og:type" content="article">
<meta property="og:title" content="「论文系列」（二）重读单阶段目标检测器SSD">
<meta property="og:url" content="https://username.github.io/2022/05/27/%E3%80%8C%E8%AE%BA%E6%96%87%E7%B3%BB%E5%88%97%E3%80%8D%EF%BC%88%E4%BA%8C%EF%BC%89%E9%87%8D%E8%AF%BB%E5%8D%95%E9%98%B6%E6%AE%B5%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E5%99%A8SSD/index.html">
<meta property="og:site_name" content="陨石kk的博客">
<meta property="og:description" content="论文简介论文作者呈现了一种仅需要单个深度神经网络的目标检测算法「端到端」；设计其在不同尺寸的特征图下进行预测以处理不同尺度大小的物体；摒弃了之前那种双阶段目标检测器需要生成$Region\  Proposal$和特征再筛选的过程；基于$Nvidia\  Titan\  X$上，针对大小为300*300大小的输入，在VOC2007数据集上测试的$mAP$为$74.3%$，速度为$59FPS$，对于5">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nejiu54jj20s009yac7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nekjhfr4j20f70a93yz.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvbgokx6j20wv0ji77l.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvu9302jj20cu05kdg5.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvwn5r6kj20yd0cqn07.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvzh5c98j20de0afjs5.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nx2wqvwjj20e2038weo.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2ny1copqqj20kt04wq36.jpg">
<meta property="article:published_time" content="2022-05-27T15:07:00.000Z">
<meta property="article:modified_time" content="2022-05-28T07:30:27.459Z">
<meta property="article:author" content="陨石kk">
<meta property="article:tag" content="论文系列">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nejiu54jj20s009yac7.jpg">


<link rel="canonical" href="https://username.github.io/2022/05/27/%E3%80%8C%E8%AE%BA%E6%96%87%E7%B3%BB%E5%88%97%E3%80%8D%EF%BC%88%E4%BA%8C%EF%BC%89%E9%87%8D%E8%AF%BB%E5%8D%95%E9%98%B6%E6%AE%B5%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E5%99%A8SSD/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://username.github.io/2022/05/27/%E3%80%8C%E8%AE%BA%E6%96%87%E7%B3%BB%E5%88%97%E3%80%8D%EF%BC%88%E4%BA%8C%EF%BC%89%E9%87%8D%E8%AF%BB%E5%8D%95%E9%98%B6%E6%AE%B5%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E5%99%A8SSD/","path":"2022/05/27/「论文系列」（二）重读单阶段目标检测器SSD/","title":"「论文系列」（二）重读单阶段目标检测器SSD"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>「论文系列」（二）重读单阶段目标检测器SSD | 陨石kk的博客</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">陨石kk的博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-主页"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>主页</a></li><li class="menu-item menu-item-标签"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-归档"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-关于"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BA%E6%96%87%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">论文简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5"><span class="nav-number">2.</span> <span class="nav-text">设计理念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%87%E7%94%A8%E5%A4%9A%E5%B0%BA%E5%BA%A6%E7%89%B9%E5%BE%81%E5%9B%BE%EF%BC%88%E4%B8%8D%E5%90%8C%E5%A4%A7%E5%B0%8FFeature-Map%EF%BC%89"><span class="nav-number">2.1.</span> <span class="nav-text">采用多尺度特征图（不同大小Feature Map）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%87%E7%94%A8%E5%8D%B7%E7%A7%AF%E4%B8%8ENMS%E8%BF%9B%E8%A1%8C%E6%A3%80%E6%B5%8B%EF%BC%88%E4%B8%8D%E4%BD%BF%E7%94%A8%E5%85%A8%E8%BF%9E%E6%8E%A5%EF%BC%8C%E6%8F%90%E9%80%9F%EF%BC%89"><span class="nav-number">2.2.</span> <span class="nav-text">采用卷积与NMS进行检测（不使用全连接，提速）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%85%88%E9%AA%8C%E6%A1%86%EF%BC%88%E7%B1%BB%E4%BC%BCFaster-R-CNN-%E4%BD%86%E5%8F%88%E6%9C%89%E4%B8%8D%E5%90%8C%EF%BC%89"><span class="nav-number">2.3.</span> <span class="nav-text">设置先验框（类似Faster R-CNN 但又有不同）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84%E4%B8%8E%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B"><span class="nav-number">3.</span> <span class="nav-text">网络结构与训练过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%A8%A1%E5%9E%8B"><span class="nav-number">3.1.</span> <span class="nav-text">基础模型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E9%83%A8%E5%88%86%E7%BB%86%E8%8A%82"><span class="nav-number">3.1.1.</span> <span class="nav-text">模型部分细节</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E5%9B%BE%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="nav-number">3.1.2.</span> <span class="nav-text">特征图的设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%88%E9%AA%8C%E6%A1%86%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="nav-number">3.1.3.</span> <span class="nav-text">先验框的设置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%88%E9%AA%8C%E6%A1%86%E5%8C%B9%E9%85%8D%E3%80%8C%E6%AD%A3%E8%B4%9F%E6%A0%B7%E6%9C%AC%E5%8C%B9%E9%85%8D%E3%80%8D"><span class="nav-number">3.2.</span> <span class="nav-text">先验框匹配「正负样本匹配」</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%B0%E9%9A%BE%E6%A0%B7%E6%9C%AC%E6%8C%96%E6%8E%98"><span class="nav-number">3.2.1.</span> <span class="nav-text">困难样本挖掘</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="nav-number">3.3.</span> <span class="nav-text">损失函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%BD%8D%E6%8D%9F%E5%A4%B1%E3%80%8CSmooth-L1-Loss%E3%80%8D"><span class="nav-number">3.3.1.</span> <span class="nav-text">定位损失「Smooth L1 Loss」</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E6%8D%9F%E5%A4%B1%E3%80%8C%E4%BA%A4%E5%8F%89%E7%86%B5%E3%80%8D"><span class="nav-number">3.3.2.</span> <span class="nav-text">分类损失「交叉熵」</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%B9%BF"><span class="nav-number">3.4.</span> <span class="nav-text">数据增广</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E5%90%91%E6%B5%81%E7%A8%8B"><span class="nav-number">4.</span> <span class="nav-text">前向流程</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="陨石kk"
      src="/uploads/%E5%A4%B4%E5%83%8F.jpg">
  <p class="site-author-name" itemprop="name">陨石kk</p>
  <div class="site-description" itemprop="description">无限进步</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zz0320" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zz0320" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zyc160378629@gmail.com" title="E-Mail → mailto:zyc160378629@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://username.github.io/2022/05/27/%E3%80%8C%E8%AE%BA%E6%96%87%E7%B3%BB%E5%88%97%E3%80%8D%EF%BC%88%E4%BA%8C%EF%BC%89%E9%87%8D%E8%AF%BB%E5%8D%95%E9%98%B6%E6%AE%B5%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E5%99%A8SSD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="陨石kk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陨石kk的博客">
      <meta itemprop="description" content="无限进步">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="「论文系列」（二）重读单阶段目标检测器SSD | 陨石kk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          「论文系列」（二）重读单阶段目标检测器SSD
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-27 23:07:00" itemprop="dateCreated datePublished" datetime="2022-05-27T23:07:00+08:00">2022-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-28 15:30:27" itemprop="dateModified" datetime="2022-05-28T15:30:27+08:00">2022-05-28</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="论文简介"><a href="#论文简介" class="headerlink" title="论文简介"></a>论文简介</h2><p>论文作者呈现了一种仅需要单个深度神经网络的目标检测算法「端到端」；设计其在不同尺寸的特征图下进行预测以处理不同尺度大小的物体；摒弃了之前那种双阶段目标检测器需要生成$Region\  Proposal$和特征再筛选的过程；基于$Nvidia\  Titan\  X$上，针对大小为300*300大小的输入，在VOC2007数据集上测试的$mAP$为$74.3%$，速度为$59FPS$，对于512*512的输入$mAP$为$76.9%$的$mAP$</p>
<blockquote>
<p>原文链接「<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.02325">点击这里</a>」</p>
</blockquote>
<h2 id="设计理念"><a href="#设计理念" class="headerlink" title="设计理念"></a>设计理念</h2><h3 id="采用多尺度特征图（不同大小Feature-Map）"><a href="#采用多尺度特征图（不同大小Feature-Map）" class="headerlink" title="采用多尺度特征图（不同大小Feature Map）"></a>采用多尺度特征图（不同大小Feature Map）</h3><p>用大特征图来检测小目标，小特征图来检测大目标「类似FPN」</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nejiu54jj20s009yac7.jpg"></p>
<h3 id="采用卷积与NMS进行检测（不使用全连接，提速）"><a href="#采用卷积与NMS进行检测（不使用全连接，提速）" class="headerlink" title="采用卷积与NMS进行检测（不使用全连接，提速）"></a>采用卷积与NMS进行检测（不使用全连接，提速）</h3><p>SSD直接采用卷积对不同的特征图来进行提取检测结果，直接使用卷积输出作为边框回归「定位」和类别预测「分类」</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nekjhfr4j20f70a93yz.jpg"></p>
<p>假设某个用于预测的$Feature\  Map$是$Feature\  Map$是5*5*256，$Anchor\ Box$数量为$3$，共生成5*5*3&#x3D;75个锚框</p>
<p>最后输出中，用于分类的是5*5*63，定位的是5*5*12</p>
<span id="more"></span>

<h3 id="设置先验框（类似Faster-R-CNN-但又有不同）"><a href="#设置先验框（类似Faster-R-CNN-但又有不同）" class="headerlink" title="设置先验框（类似Faster R-CNN 但又有不同）"></a>设置先验框（类似Faster R-CNN 但又有不同）</h3><p>SSD借鉴了Faster R-CNN中的$anchor$的理念，每个点生成大小、长宽比不一致的先验框</p>
<p>每个格点设置的4个锚框（$Anchor\ Box$）由格点中心$(c_x,c_y)$和四组不同的宽高组成$(w,h)$：</p>
<ul>
<li><p>先验框：$d &#x3D; (d^{cx},d^{cy},d^{w},d^{h})$</p>
</li>
<li><p>对应边界框：$b &#x3D; (b^{cx},b^{cy},b^{w},b^{h})$</p>
</li>
<li><p>转换值「训练Target」：</p>
<p>$l^{cx}&#x3D;(b^{cx}-d^{cx})d{w},l^{cy}&#x3D;(b^{cy}-d^{cy})&#x2F;d{h},l^{w}&#x3D;log(b^{w}&#x2F;d^{w}),l^{h}&#x3D;log(b^{h}&#x2F;d^{w})$</p>
</li>
</ul>
<p>这$4$组不同的宽高$(w,h)$由min_size,max_size和不同的$aspect\  ratio$给出。图中一共可以给出8*8*4个锚框用于回归物体的坐标</p>
<h2 id="网络结构与训练过程"><a href="#网络结构与训练过程" class="headerlink" title="网络结构与训练过程"></a>网络结构与训练过程</h2><h3 id="基础模型"><a href="#基础模型" class="headerlink" title="基础模型"></a>基础模型</h3><p>$VGG16$作为$Backbone$&amp;多尺度检测</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvbgokx6j20wv0ji77l.jpg"></p>
<h4 id="模型部分细节"><a href="#模型部分细节" class="headerlink" title="模型部分细节"></a>模型部分细节</h4><ul>
<li>$VGG16$是在$ILSVRC\ CLS-10$数据集上进行预训练</li>
<li>$VGG16$的全连接层$FC6$和$FC7$转换为3*3的 $Conv6$和1*1的$Conv7$</li>
<li>池化层从原先的$Stride&#x3D;2$的2*2转化为$Stride&#x3D;1$的3*3</li>
<li>移除$dropout$和$FC8$，新增一系列的卷积层做$Finetuning$</li>
<li>在$Conv6$和$Conv7$使用$Atrous\  Convolution$（<strong>空洞卷积</strong>），在保证比传统卷积参数更小的情况下，增大感受野</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvu9302jj20cu05kdg5.jpg"></p>
<h4 id="特征图的设置"><a href="#特征图的设置" class="headerlink" title="特征图的设置"></a>特征图的设置</h4><p>在Conv7，Conv8_2，Conv9_2，Conv10_2，Conv11_2作为检测所用特征图，加入Conv4_3层，共提取$6$个特征图</p>
<p>尺寸分别为(38*38), (19*19), (10*10), (5*5), (3*3), (1*1)</p>
<h4 id="先验框的设置"><a href="#先验框的设置" class="headerlink" title="先验框的设置"></a>先验框的设置</h4><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvwn5r6kj20yd0cqn07.jpg" style="zoom:50%;" />

<p>如上图所示，在特征图的每一个位置上预测$K$个$Bounding\  Box$，对于每个$Bounding\  Box$，预测$C$个类别得分，以及相对于$Default\ Box$的$4$个偏移量值，这样总共需要(C+4)*K个预测器，则在m*n的特征图上面会产生(C+4)*K*m*n个<strong>预测值</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nvzh5c98j20de0afjs5.jpg"></p>
<p>对于先验框的尺度，其遵守一个线性递增原则，随着特征图大小降低，先验框尺度增加：<br>$$<br>S_k &#x3D; S_{min} + \frac{S_{max}-S_{min}}{m-1}(k-1), k\in [1,m]<br>$$</p>
<ul>
<li>$m$指代的是特征图个数，但是设定为$5$，因为Con4_3是单独设置的</li>
<li>$S_k$代表先验框大小相当于图片的比例。S_min与S_max表示比例的最大值和最小值，一般设定为$0.2$和$0.9$</li>
</ul>
<p>对于第一个特征图，其先验框的尺度比例一般设定为S_min&#x2F;2 &#x3D; 0.1，尺度为「图像大小*尺度比例」：「$300*0.1&#x3D;30$」</p>
<p>对于后面的特征图，先验框尺度按照上面公式进行线性增加，但是先将尺度比例扩大$100$倍，此时增长步长为<br>$$<br>\left  \lfloor\frac{\left  \lfloor S_{max} *100 \right \rfloor  - \left  \lfloor S_{min} *100 \right \rfloor}{m - 1}   \right \rfloor  &#x3D; 17<br>$$<br>这样各个$Feature\  Map$的$S_k$为$20，37，54，71，88$。将这些比例除以$100$，然后再乘以图片大小「默认$300$」，可以得到各个$Feature\  Map$的尺度为$30，60，111，162，213，264$</p>
<p>对于长宽比，一般$\alpha_{\gamma} $选择${1,2,3,1&#x2F;2,1&#x2F;3}$，根据面积和长宽比可以得到先验框的$w$和$h$:<br>$$<br>w_k^\alpha &#x3D; S_k\sqrt{\alpha_\gamma}<br>$$</p>
<p>$$<br>h_k^\alpha &#x3D; S_k&#x2F;\sqrt{\alpha_\gamma}<br>$$</p>
<ul>
<li>上面的$S_k$是相对于原图的大小</li>
<li>默认情况下，每个特征图除了上面$5$个比例的$Anchor$，还会设置一个尺度为$S_k^{‘}&#x3D;\sqrt{s_ks_{k+1}}$ 且$\alpha_\gamma&#x3D;1$的先验框，这样每个特征图都设置了两个长宽比为1且大小不同的正方形先验框。最后一个特征图需要参考一下$S_{m+1}&#x3D;315$来计算$S_m$</li>
<li>在实现Conv4_3, Conv10_2, Conv11_2层时仅使用四个先验框，不使用长宽比为$3, \frac{1}{3}$的$Anchor$</li>
<li>每个单元的先验框中心点分布在每个单元的中心，即：$[\frac{i+0.5}{|f_k|},\frac{j+0.5}{|f_{k}|}],i,j\in[0,|f_k|]$，其中$f_k$是特征图的大小</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2nx2wqvwjj20e2038weo.jpg"></p>
<blockquote>
<p>对于不同场景中，这些手工的先验框可能不适用，所以用YOLO的多「YOLO是用K-means聚类学习得到的」</p>
</blockquote>
<h3 id="先验框匹配「正负样本匹配」"><a href="#先验框匹配「正负样本匹配」" class="headerlink" title="先验框匹配「正负样本匹配」"></a>先验框匹配「正负样本匹配」</h3><ul>
<li>第一原则：对于图片中的每一个Ground Truth，找到与其IoU最大的先验框「很少，负样本过多，所以有原则二」</li>
<li>第二原则：对于剩余的未匹配先验框，若某个Ground Truth的IoU高于某个阈值（一般是0.5），那么该先验框也与这个GT进行匹配「YOLOv3是取IoU最大的为正样本，低于0.3的为负样本，其他的不做处理」</li>
</ul>
<p>​	正样本：通常称与Ground Truth匹配的先验框</p>
<p>​	负样本：若一个先验框没有与任何Ground Truth进行匹配，只能与背景匹配</p>
<h4 id="困难样本挖掘"><a href="#困难样本挖掘" class="headerlink" title="困难样本挖掘"></a>困难样本挖掘</h4><p>为了保证正负样本尽量平衡，$SSD$采用了困难样本挖掘，就是对负样本进行抽样，抽样的时候按照置信度误差「<strong>预测背景的置信度越小，误差越大</strong>」进行降序排列，选取误差较大的$Top-K$作为训练的负样本，以保证正负样本比例为$1:3$</p>
<h3 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h3><p>损失函数包含两部分：「<strong>定位损失</strong>」和「<strong>分类损失</strong>」，最后总损失为二者的加权和<br>$$<br>L(x,c,l,g) &#x3D; \frac{1}{N}(L_{conf}(x,c) + \alpha L_{loc}(x,l,g))<br>$$</p>
<h4 id="定位损失「Smooth-L1-Loss」"><a href="#定位损失「Smooth-L1-Loss」" class="headerlink" title="定位损失「Smooth L1 Loss」"></a>定位损失「Smooth L1 Loss」</h4><p>$$<br>L_{loc}(x,l,g) &#x3D; \sum_{i\in{Pos}}^{N}\  \sum_{m \in{cx,cy,w,h}}x_{ij}^kSmooth_{L1}{(l_i^m - \hat{g_j^m})}<br>$$</p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2ny1copqqj20kt04wq36.jpg" style="zoom: 50%;" />

<p>其中，$x_{ij}^k$表示第$i$个预测框与第$k$个真实框关于类别$k$是否匹配，如果匹配则为$1$否则为$0$；$l_i^m$为预测框，$\hat{g_j^m}$为真实框</p>
<h4 id="分类损失「交叉熵」"><a href="#分类损失「交叉熵」" class="headerlink" title="分类损失「交叉熵」"></a>分类损失「交叉熵」</h4><p>$$<br>L_{conf}(x,c) &#x3D; -\sum_{i\in{Pos}}^{N}\ x_{ij}^plog(\hat c_i^p) - \sum_{i\in{Neg}}\ log(\hat c_i^0) \ where \  \hat{c_i^p} &#x3D; \frac{exp(c_i^p)}{\sum_pexp(c_i^p)}<br>$$</p>
<p>其中，$x_{ij}^plog(\hat c_i^p)$表示预测框$i$与真实框$j$关于类别$p$匹配，则$p$的预测概率越高，损失越小；$\hat c_i^p$表示预测框其实没有物体，则预测为背景的概率越高，损失越小</p>
<h3 id="数据增广"><a href="#数据增广" class="headerlink" title="数据增广"></a>数据增广</h3><p>主要采用的方法有：</p>
<ul>
<li>水平翻转</li>
<li>随机剪裁</li>
<li>色彩扰动</li>
<li>随机采集块域（获取小样本）</li>
</ul>
<h2 id="前向流程"><a href="#前向流程" class="headerlink" title="前向流程"></a>前向流程</h2><ul>
<li>对于每个预测框，首先根据类别置信度确定其类别（置信度最大者）与置信度值，并过滤掉属于背景的预测框</li>
<li>根据置信度阈值$(0.5)$过滤掉阈值较低的预测框。对于留下的预测框进行解码「根据先验框得到真实的位置参数」（解码时，一般还要做$Clip$，防止预测框位置超过图片）</li>
<li>解码后，一般需要按照置信度阈值降序排列，然后仅保留$Top-K$个预测框</li>
<li>最后进行$NMS$，过滤掉重叠较大的预测值</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%AE%BA%E6%96%87%E7%B3%BB%E5%88%97/" rel="tag"># 论文系列</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/05/23/%E3%80%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E3%80%8D%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/" rel="prev" title="「深度学习基础」语义分割损失函数">
                  <i class="fa fa-chevron-left"></i> 「深度学习基础」语义分割损失函数
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">陨石kk</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>
--!>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
